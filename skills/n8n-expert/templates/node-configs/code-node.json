{
  "_description": "Code Node Configuration Examples",
  "_nodeType": "n8n-nodes-base.code",
  "_typeVersion": 2,

  "examples": {
    "transform_all_items": {
      "description": "Transform all items at once",
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "const items = $input.all();\n\nreturn items.map(item => ({\n  json: {\n    ...item.json,\n    transformed: true\n  }\n}));"
      }
    },

    "transform_each_item": {
      "description": "Transform each item separately",
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const data = $input.item.json;\n\nreturn {\n  json: {\n    original: data,\n    processed: true\n  }\n};"
      }
    },

    "filter_items": {
      "description": "Filter items based on condition",
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "const items = $input.all();\n\nconst filtered = items.filter(item => \n  item.json.status === 'active' && \n  item.json.value > 100\n);\n\nreturn filtered;"
      }
    },

    "aggregate_data": {
      "description": "Aggregate/summarize data",
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "const items = $input.all();\n\nconst total = items.reduce((sum, item) => sum + item.json.amount, 0);\nconst count = items.length;\nconst average = count > 0 ? total / count : 0;\n\nreturn [{\n  json: {\n    totalAmount: total,\n    itemCount: count,\n    averageAmount: average\n  }\n}];"
      }
    },

    "group_by_field": {
      "description": "Group items by a field",
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "const items = $input.all();\n\nconst grouped = {};\nitems.forEach(item => {\n  const key = item.json.category;\n  if (!grouped[key]) grouped[key] = [];\n  grouped[key].push(item.json);\n});\n\nreturn Object.entries(grouped).map(([category, items]) => ({\n  json: { category, items, count: items.length }\n}));"
      }
    },

    "flatten_nested": {
      "description": "Flatten nested array",
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "const items = $input.all();\n\nconst flattened = items.flatMap(item => \n  item.json.nestedArray.map(nested => ({\n    json: {\n      parentId: item.json.id,\n      ...nested\n    }\n  }))\n);\n\nreturn flattened;"
      }
    },

    "date_manipulation": {
      "description": "Work with dates",
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const data = $input.item.json;\nconst date = new Date(data.dateString);\n\nreturn {\n  json: {\n    ...data,\n    year: date.getFullYear(),\n    month: date.getMonth() + 1,\n    day: date.getDate(),\n    dayOfWeek: date.toLocaleDateString('en-US', { weekday: 'long' }),\n    iso: date.toISOString(),\n    timestamp: date.getTime()\n  }\n};"
      }
    },

    "http_request": {
      "description": "Make HTTP request in code",
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "const items = $input.all();\n\nconst results = [];\nfor (const item of items) {\n  const response = await fetch(`https://api.example.com/data/${item.json.id}`);\n  const data = await response.json();\n  results.push({ json: { ...item.json, apiData: data } });\n}\n\nreturn results;"
      }
    },

    "error_handling": {
      "description": "Handle errors gracefully",
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "const items = $input.all();\n\nconst results = [];\nfor (const item of items) {\n  try {\n    // Processing that might fail\n    const processed = JSON.parse(item.json.jsonString);\n    results.push({ json: { success: true, data: processed } });\n  } catch (error) {\n    results.push({ \n      json: { \n        success: false, \n        error: error.message,\n        originalData: item.json \n      } \n    });\n  }\n}\n\nreturn results;"
      }
    },

    "access_previous_node": {
      "description": "Access data from specific previous node",
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "// Get data from specific node\nconst webhookData = $('Webhook').first().json;\nconst httpData = $('HTTP Request').all();\n\nreturn [{\n  json: {\n    fromWebhook: webhookData,\n    httpItemCount: httpData.length\n  }\n}];"
      }
    },

    "python_example": {
      "description": "Python code example",
      "parameters": {
        "mode": "runOnceForAllItems",
        "language": "python",
        "pythonCode": "import json\nfrom datetime import datetime\n\nitems = _input.all()\n\nresults = []\nfor item in items:\n    results.append({\n        'json': {\n            **item.json,\n            'processed': True,\n            'timestamp': datetime.now().isoformat()\n        }\n    })\n\nreturn results"
      }
    }
  },

  "available_variables": {
    "input": [
      "$input.all() - All input items",
      "$input.first() - First input item",
      "$input.item - Current item (in forEach mode)"
    ],
    "data": [
      "$json - Current item JSON",
      "$binary - Binary data",
      "$('Node Name').all() - All items from node",
      "$('Node Name').first() - First item from node"
    ],
    "context": [
      "$env - Environment variables",
      "$workflow - Workflow info (.name, .id, .active)",
      "$execution - Execution info (.id, .mode, .resumeUrl)",
      "$node - Current node info",
      "$prevNode - Previous node info"
    ],
    "time": [
      "$now - Current DateTime",
      "$today - Today's date"
    ]
  },

  "template": {
    "id": "code-1",
    "name": "Code",
    "type": "n8n-nodes-base.code",
    "typeVersion": 2,
    "position": [450, 300],
    "parameters": {
      "mode": "runOnceForAllItems",
      "jsCode": "// Your code here\nconst items = $input.all();\n\nreturn items;"
    }
  }
}
